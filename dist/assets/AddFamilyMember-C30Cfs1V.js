import{r as s,j as e}from"./vendor-radix-htwXsPHy.js";import{u as Y}from"./vendor-query-BNGVDYIL.js";import{u as A,j as E,C as P,S as V,I as b,a as g,b as j,c as v,d as N,e as t,B as y,f as S}from"./index-Bu4m9iDU.js";import{R as C}from"./Radio-DrmiZSAn.js";import{createProfile as _}from"./profileStorage-B9P4N8Co.js";import{B as L}from"./birth-date-picker-DZK-huiu.js";import{u as Q,a as G}from"./vendor-react-CI8wve7f.js";import"./vendor-charts-DjioKZbK.js";import"./vendor-date-CR4liJ_d.js";function Z(){const r=Q(),x=G(),k=Y(),{user:l}=A(),[i,w]=s.useState(""),[n,B]=s.useState(""),[o,F]=s.useState(""),[c,I]=s.useState(""),[d,R]=s.useState(""),[h,q]=s.useState(""),[u,D]=s.useState(""),[m,f]=s.useState(!1),z=async a=>{var p;if(a.preventDefault(),!m&&i&&n&&o&&c&&d&&u)try{f(!0),await _({firstName:i,lastName:n,dateOfBirth:o,relationship:c,sex:d,referral:h,seekingCare:u}),await k.invalidateQueries({queryKey:["profiles",l==null?void 0:l.id]}),S.success("Член семьи успешно добавлен!"),((p=x.state)==null?void 0:p.from)==="cabinet"?r("/cabinet"):r("/family-members")}catch(O){console.error("Error creating profile:",O),S.error("Ошибка при добавлении члена семьи"),f(!1)}};return e.jsx("div",{className:"min-h-screen",style:{backgroundImage:`url(${E})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",backgroundRepeat:"no-repeat"},children:e.jsx("div",{className:"container mx-auto max-w-2xl px-4 py-12",children:e.jsx(P,{className:"rounded-[20px] border-2 bg-white p-8 shadow-[0_4px_20px_rgba(0,0,0,0.06)]",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"text-center",children:e.jsx(V,{size:"2xl",className:"mb-4",children:"Расскажите нам больше о члене семьи"})}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsx(b,{id:"firstName",type:"text",label:"Имя *",value:i,onChange:a=>w(a.target.value),required:!0}),e.jsx(b,{id:"lastName",type:"text",label:"Фамилия *",value:n,onChange:a=>B(a.target.value),required:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"dateOfBirth",className:"text-sm font-medium text-foreground",children:["Дата рождения ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(L,{id:"dateOfBirth",value:o,onChange:F,required:!0,fromYear:new Date().getFullYear()-100,toYear:new Date().getFullYear()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"relationship",className:"text-sm font-medium text-foreground",children:["Кем для вас приходится? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(g,{value:c,onValueChange:I,children:[e.jsx(j,{id:"relationship",className:"h-14 text-base rounded-2xl border-2 border-muted bg-white/80 backdrop-blur-sm transition-all duration-200 focus:border-coral-light focus:outline-none focus:ring-0 data-[state=open]:border-coral-light",children:e.jsx(v,{placeholder:"Выберите"})}),e.jsxs(N,{className:"rounded-2xl",children:[e.jsx(t,{value:"child",children:"Ребенок"}),e.jsx(t,{value:"partner",children:"Партнер"}),e.jsx(t,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Пол ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(C,{name:"sex",value:d,onChange:R,options:[{value:"male",label:"Мужской"},{value:"female",label:"Женский"}],className:"grid grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"referral",className:"text-sm font-medium text-foreground",children:"Пришел по направлению от организации?"}),e.jsxs(g,{value:h,onValueChange:q,children:[e.jsx(j,{id:"referral",className:"h-14 text-base rounded-2xl border-2 border-muted bg-white/80 backdrop-blur-sm transition-all duration-200 focus:border-coral-light focus:outline-none focus:ring-0 data-[state=open]:border-coral-light",children:e.jsx(v,{placeholder:"Нет направления"})}),e.jsxs(N,{className:"rounded-2xl",children:[e.jsx(t,{value:"no",children:"Нет направления"}),e.jsx(t,{value:"insurance",children:"Страховая компания"}),e.jsx(t,{value:"doctor",children:"Врач"}),e.jsx(t,{value:"school",children:"Школа"}),e.jsx(t,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Этому члену семьи нужна помощь? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(C,{name:"seekingCare",value:u,onChange:D,options:[{value:"yes",label:"Да"},{value:"no",label:"Нет"}],className:"grid grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(y,{type:"button",variant:"outline",size:"lg",onClick:()=>{var a;((a=x.state)==null?void 0:a.from)==="cabinet"?r("/cabinet"):r("/family-members")},className:"h-14 flex-1 text-base font-medium",children:"Назад"}),e.jsx(y,{type:"submit",size:"lg",disabled:m,className:"h-14 flex-1 text-base font-medium",children:m?"Добавление...":"Добавить"})]})]})]})})})})}export{Z as default};
