import{r as t,j as e}from"./vendor-radix-htwXsPHy.js";import{u as z}from"./vendor-query-BNGVDYIL.js";import{u as E,H,a as V,I as j,b as g,c as b,d as v,e as N,f as s,B as y,g as S}from"./index-Dv2C02zj.js";import{R as C}from"./Radio-6SPOB3xD.js";import{createProfile as A}from"./profileStorage-CNyPVPjQ.js";import{B as L}from"./birth-date-picker-RdMiatSZ.js";import{u as P,a as Q}from"./vendor-react-CI8wve7f.js";import"./vendor-charts-DjioKZbK.js";import"./vendor-date-CR4liJ_d.js";function _(){const r=P(),x=Q(),k=z(),{user:l}=E(),[i,B]=t.useState(""),[n,w]=t.useState(""),[o,F]=t.useState(""),[c,q]=t.useState(""),[d,D]=t.useState(""),[h,R]=t.useState(""),[u,I]=t.useState(""),[m,f]=t.useState(!1),O=async a=>{var p;if(a.preventDefault(),!m&&i&&n&&o&&c&&d&&u)try{f(!0),await A({firstName:i,lastName:n,dateOfBirth:o,relationship:c,sex:d,referral:h,seekingCare:u}),await k.invalidateQueries({queryKey:["profiles",l==null?void 0:l.id]}),S.success("Член семьи успешно добавлен!"),((p=x.state)==null?void 0:p.from)==="cabinet"?r("/cabinet"):r("/family-members")}catch(Y){console.error("Error creating profile:",Y),S.error("Ошибка при добавлении члена семьи"),f(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(H,{}),e.jsx("div",{className:"container mx-auto max-w-2xl px-4 py-12",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"text-center",children:e.jsx(V,{size:"2xl",className:"mb-4",children:"Расскажите нам больше о члене семьи"})}),e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[e.jsx(j,{id:"firstName",type:"text",label:"Имя *",value:i,onChange:a=>B(a.target.value),required:!0}),e.jsx(j,{id:"lastName",type:"text",label:"Фамилия *",value:n,onChange:a=>w(a.target.value),required:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"dateOfBirth",className:"text-sm font-medium text-foreground",children:["Дата рождения ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(L,{id:"dateOfBirth",value:o,onChange:F,required:!0,fromYear:new Date().getFullYear()-100,toYear:new Date().getFullYear()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"relationship",className:"text-sm font-medium text-foreground",children:["Кем для вас приходится? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(g,{value:c,onValueChange:q,children:[e.jsx(b,{id:"relationship",className:"h-14 text-base rounded-2xl border-2 border-muted bg-white/80 backdrop-blur-sm transition-all duration-200 focus:border-coral-light focus:outline-none focus:ring-0 data-[state=open]:border-coral-light",children:e.jsx(v,{placeholder:"Выберите"})}),e.jsxs(N,{className:"rounded-2xl",children:[e.jsx(s,{value:"child",children:"Ребенок"}),e.jsx(s,{value:"partner",children:"Партнер"}),e.jsx(s,{value:"parent",children:"Родитель"}),e.jsx(s,{value:"sibling",children:"Брат/Сестра"}),e.jsx(s,{value:"caregiver",children:"Опекун"}),e.jsx(s,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Пол ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(C,{name:"sex",value:d,onChange:D,options:[{value:"male",label:"Мужской"},{value:"female",label:"Женский"}],className:"grid grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"referral",className:"text-sm font-medium text-foreground",children:"Пришел по направлению от организации?"}),e.jsxs(g,{value:h,onValueChange:R,children:[e.jsx(b,{id:"referral",className:"h-14 text-base rounded-2xl border-2 border-muted bg-white/80 backdrop-blur-sm transition-all duration-200 focus:border-coral-light focus:outline-none focus:ring-0 data-[state=open]:border-coral-light",children:e.jsx(v,{placeholder:"Нет направления"})}),e.jsxs(N,{className:"rounded-2xl",children:[e.jsx(s,{value:"no",children:"Нет направления"}),e.jsx(s,{value:"insurance",children:"Страховая компания"}),e.jsx(s,{value:"doctor",children:"Врач"}),e.jsx(s,{value:"school",children:"Школа"}),e.jsx(s,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"text-sm font-medium text-foreground",children:["Этому члену семьи нужна помощь? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(C,{name:"seekingCare",value:u,onChange:I,options:[{value:"yes",label:"Да"},{value:"no",label:"Нет"}],className:"grid grid-cols-2 gap-4"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(y,{type:"button",variant:"outline",size:"lg",onClick:()=>{var a;((a=x.state)==null?void 0:a.from)==="cabinet"?r("/cabinet"):r("/family-members")},className:"h-14 flex-1 text-base font-medium",children:"Назад"}),e.jsx(y,{type:"submit",size:"lg",disabled:m,className:"h-14 flex-1 text-base font-medium",children:m?"Добавление...":"Добавить"})]})]})]})})]})}export{_ as default};
