import{j as e}from"./vendor-radix-htwXsPHy.js";import{L as c,e as y}from"./vendor-react-CI8wve7f.js";import{w as v,aA as p,ay as f,s as _,az as N}from"./index-Bu4m9iDU.js";import{b as w}from"./vendor-query-BNGVDYIL.js";import{u}from"./useBlogPosts-DjmY0B33.js";import{u as L,f as g,a as h}from"./Blog-BQAsUJVB.js";import"./vendor-charts-DjioKZbK.js";function k(r){return w({queryKey:["blog-post",r],enabled:!!r,queryFn:async()=>{if(!r)return null;const{data:t,error:a}=await v.from("blog_posts").select("*").eq("slug",r).eq("status","published").lte("published_at",new Date().toISOString()).maybeSingle();if(a)throw a;return t||null}})}function P({items:r,currentTitle:t,currentUrl:a}){const i="https://waves.ru",m={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:[...r.map((l,o)=>({"@type":"ListItem",position:o+1,name:l.name,item:`${i}${l.url}`})),{"@type":"ListItem",position:r.length+1,name:t,item:`${i}${a}`}]};return e.jsxs(e.Fragment,{children:[e.jsx(p,{children:e.jsx("script",{type:"application/ld+json",children:JSON.stringify(m)})}),e.jsx("nav",{"aria-label":"Хлебные крошки",itemScope:!0,itemType:"https://schema.org/BreadcrumbList",className:"blog-breadcrumbs",children:e.jsxs("ol",{className:"blog-breadcrumbs-list",children:[r.map((l,o)=>e.jsxs("li",{itemProp:"itemListElement",itemScope:!0,itemType:"https://schema.org/ListItem",className:"blog-breadcrumbs-item",children:[e.jsx(c,{to:l.url,itemProp:"item",className:"blog-breadcrumbs-link",children:e.jsx("span",{itemProp:"name",children:l.name})}),e.jsx("meta",{itemProp:"position",content:String(o+1)}),e.jsx("span",{className:"blog-breadcrumbs-separator","aria-hidden":"true",children:"/"})]},l.url)),e.jsxs("li",{itemProp:"itemListElement",itemScope:!0,itemType:"https://schema.org/ListItem",className:"blog-breadcrumbs-item blog-breadcrumbs-item--current",children:[e.jsx("span",{itemProp:"name",className:"blog-breadcrumbs-current",children:t}),e.jsx("meta",{itemProp:"item",content:`${i}${a}`}),e.jsx("meta",{itemProp:"position",content:String(r.length+1)})]})]})})]})}function q(){const{slug:r}=y(),{data:t,isLoading:a,isError:i}=k(r),{data:n}=L(),{data:m}=u({category:(t==null?void 0:t.category_slug)||void 0,limit:4,excludeSlug:r,enabled:!!(t!=null&&t.category_slug)}),{data:l}=u({limit:6,excludeSlug:r}),o=(()=>{const s=m||[];if(s.length>=3)return s.slice(0,3);const b=new Set(s.map(x=>x.id)),j=(l||[]).filter(x=>!b.has(x.id));return[...s,...j].slice(0,3)})(),d=n==null?void 0:n.find(s=>s.slug===(t==null?void 0:t.category_slug));return e.jsxs("div",{className:"blog-article-bg flex min-h-screen flex-col",children:[e.jsx(f,{}),e.jsxs("main",{className:"flex-1",children:[e.jsxs("div",{className:"container mx-auto px-4 py-8 md:py-10 lg:py-12",children:[a&&e.jsx("p",{className:"text-sm text-white/60",children:"Загружаем статью…"}),i&&e.jsx("p",{className:"text-sm text-red-300",children:"Не удалось загрузить статью. Попробуйте позже."}),!a&&!i&&!t&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"font-display text-2xl font-semibold md:text-3xl",children:"Статья не найдена"}),e.jsx("p",{className:"text-sm text-white/70",children:"Возможно, ссылка устарела или материал ещё не опубликован."}),e.jsx(c,{to:"/blog",className:"inline-flex text-sm font-medium text-[hsl(var(--color-honey))] hover:underline",children:"← Вернуться в блог"})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(p,{children:[e.jsxs("title",{children:[t.title," | Блог Waves"]}),e.jsx("meta",{name:"description",content:t.subtitle||t.title}),e.jsx("link",{rel:"canonical",href:`https://waves.ru/blog/${t.slug}`}),e.jsx("meta",{property:"og:type",content:"article"}),e.jsx("meta",{property:"og:title",content:t.title}),e.jsx("meta",{property:"og:description",content:t.subtitle||t.title}),e.jsx("meta",{property:"og:url",content:`https://waves.ru/blog/${t.slug}`}),t.cover_image_url&&e.jsx("meta",{property:"og:image",content:t.cover_image_url}),e.jsx("meta",{property:"article:published_time",content:t.published_at}),t.updated_at&&e.jsx("meta",{property:"article:modified_time",content:t.updated_at}),t.category&&e.jsx("meta",{property:"article:section",content:t.category}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:t.title}),e.jsx("meta",{name:"twitter:description",content:t.subtitle||t.title}),t.cover_image_url&&e.jsx("meta",{name:"twitter:image",content:t.cover_image_url}),e.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"Article",headline:t.title,...t.subtitle&&{description:t.subtitle},...t.cover_image_url&&{image:t.cover_image_url},datePublished:t.published_at,dateModified:t.updated_at||t.published_at,url:`https://waves.ru/blog/${t.slug}`,...t.author_name&&{author:{"@type":"Person",name:t.author_name}},publisher:{"@type":"Organization",name:"Waves",url:"https://waves.ru",logo:{"@type":"ImageObject",url:"https://waves.ru/logo.png"}},...t.category&&{articleSection:t.category},mainEntityOfPage:{"@type":"WebPage","@id":`https://waves.ru/blog/${t.slug}`}})})]}),e.jsxs("article",{className:"blog-article-shell mx-auto max-w-4xl px-5 py-7 md:px-8 md:py-9 lg:px-10 lg:py-10",children:[e.jsx(P,{items:[{name:"Главная",url:"/"},{name:"Блог",url:"/blog"},...d?[{name:d.label,url:`/blog/category/${d.slug}`}]:[]],currentTitle:t.title,currentUrl:`/blog/${t.slug}`}),t.cover_image_url&&e.jsxs("div",{className:"blog-cover-split mb-8 mx-auto overflow-hidden rounded-3xl",children:[e.jsx("div",{className:"blog-cover-image-section",children:e.jsx("img",{src:t.cover_image_url,alt:t.title,className:"blog-cover-image"})}),e.jsxs("div",{className:"blog-cover-text-section",children:[t.category&&e.jsx("div",{className:"blog-cover-category",children:t.category}),e.jsx("h1",{className:"blog-cover-title",children:t.title}),t.subtitle&&e.jsx("p",{className:"blog-cover-subtitle",children:t.subtitle}),e.jsx("div",{className:"blog-cover-date",children:g(t.published_at)})]})]}),!t.cover_image_url&&e.jsxs("header",{className:"mb-7 md:mb-8",children:[e.jsxs("div",{className:"mb-3 flex flex-wrap items-center gap-2 text-xs uppercase tracking-wide text-[hsl(var(--color-ink))]/70",children:[t.category&&e.jsx(_,{variant:"outline",className:"border-[hsl(var(--color-ink))]/20 bg-[hsl(var(--color-ink))]/5 text-[0.65rem] font-semibold uppercase tracking-wide text-[hsl(var(--color-ink))]",children:t.category}),e.jsx("span",{children:g(t.published_at)}),t.reading_time_minutes&&e.jsxs("span",{children:["• ",h(t.reading_time_minutes)]})]}),e.jsx("h1",{className:"mb-3 font-display text-3xl font-bold text-[hsl(var(--color-ink))] md:text-4xl lg:text-5xl",children:t.title}),t.subtitle&&e.jsx("p",{className:"text-lg text-[hsl(var(--color-ink))]/80 md:text-xl",children:t.subtitle}),t.author_name&&e.jsxs("p",{className:"mt-4 text-sm text-[hsl(var(--color-ink))]/70",children:["Автор: ",t.author_name]})]}),t.content_html&&e.jsx("div",{className:"prose",dangerouslySetInnerHTML:{__html:t.content_html}}),e.jsx("div",{className:"mt-10 border-t border-[hsl(var(--color-ink))]/10 pt-4",children:e.jsx(c,{to:"/blog",className:"inline-flex text-sm font-medium text-[hsl(var(--color-honey))] hover:underline",children:"← Ко всем статьям"})})]})]})]}),t&&o.length>0&&e.jsx("section",{className:"border-t border-white/10 py-8 md:py-10 bg-[hsl(var(--color-ink))]",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h2",{className:"mb-4 font-display text-2xl font-semibold text-white md:text-3xl",children:"Ещё по теме"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:o.map(s=>e.jsxs(c,{to:`/blog/${s.slug}`,className:"group block h-full rounded-2xl border border-white/5 p-4 transition-transform transition-colors hover:-translate-y-0.5 hover:border-white/25 bg-[hsl(var(--color-ink))]",children:[s.cover_image_url&&e.jsx("div",{className:"mb-3 h-32 w-full overflow-hidden rounded-xl bg-[hsl(var(--color-ink)/0.8)]",children:e.jsx("img",{src:s.cover_image_url,alt:s.title,className:"h-full w-full object-cover transition-transform duration-500 group-hover:scale-[1.03]"})}),e.jsxs("div",{className:"mb-1 flex flex-wrap items-center gap-2 text-xs uppercase tracking-wide text-white/60",children:[s.category&&e.jsx("span",{className:"rounded-full bg-white/5 px-2 py-0.5 text-[0.65rem] font-semibold text-white/80",children:s.category}),e.jsx("span",{children:g(s.published_at)}),s.reading_time_minutes&&e.jsxs("span",{children:["• ",h(s.reading_time_minutes)]})]}),e.jsx("h3",{className:"mb-1 font-display text-base font-semibold text-white/90 group-hover:text-white",children:s.title}),s.subtitle&&e.jsx("p",{className:"line-clamp-2 text-xs text-white/70",children:s.subtitle})]},s.id))})]})})]}),e.jsx(N,{})]})}export{q as default};
