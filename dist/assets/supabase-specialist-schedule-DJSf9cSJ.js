import{v as i,m as n}from"./index-Dv2C02zj.js";async function l(){const{data:{user:e}}=await i.auth.getUser();if(!e)throw new Error("Необходима авторизация");const{data:r}=await i.from("specialists").select("id").eq("user_id",e.id).single();if(!r)throw new Error("Специалист не найден");const{data:o,error:t}=await i.from("specialist_schedules").select("*").eq("specialist_id",r.id).single();if(t){if(t.code==="PGRST116")return null;throw n.error("Error fetching schedule:",t),new Error(`Failed to fetch schedule: ${t.message}`)}return o}async function c(e){const{data:{user:r}}=await i.auth.getUser();if(!r)throw new Error("Необходима авторизация");const{data:o}=await i.from("specialists").select("id").eq("user_id",r.id).single();if(!o)throw new Error("Специалист не найден");const t={specialist_id:o.id};e.workStartTime!==void 0&&(t.work_start_time=e.workStartTime),e.workEndTime!==void 0&&(t.work_end_time=e.workEndTime),e.workDays!==void 0&&(t.work_days=e.workDays),e.breakStartTime!==void 0&&(t.break_start_time=e.breakStartTime),e.breakEndTime!==void 0&&(t.break_end_time=e.breakEndTime),e.defaultSlotDuration!==void 0&&(t.default_slot_duration=e.defaultSlotDuration),e.bufferBetweenAppointments!==void 0&&(t.buffer_between_appointments=e.bufferBetweenAppointments),e.timezone!==void 0&&(t.timezone=e.timezone);const{data:d,error:s}=await i.from("specialist_schedules").upsert(t,{onConflict:"specialist_id"}).select().single();if(s)throw n.error("Error saving schedule:",s),new Error(`Failed to save schedule: ${s.message}`);return d}export{l as g,c as s};
