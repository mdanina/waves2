import{r as i,j as e}from"./vendor-radix-htwXsPHy.js";import{g as A,u as P,S as f,C as b,ad as z,B as h,L as v,q as C,a1 as T,s as $,i as _,x as E,f as D,a9 as M,bc as R,bd as W,be as J,bf as K}from"./index-Bu4m9iDU.js";import{u as G}from"./vendor-react-CI8wve7f.js";import{P as L}from"./package-BlJ4jigW.js";import{E as F}from"./external-link-B2_JFenJ.js";import{M as Q}from"./map-pin-BBSVPYzr.js";import{S as Y}from"./sparkles-BEEHuGWZ.js";import"./vendor-charts-DjioKZbK.js";import"./vendor-query-BNGVDYIL.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=A("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=A("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=A("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),O="waves_device",B="waves_device_setup";function ee(){const{user:t}=P(),[s,n]=i.useState(null),[x,p]=i.useState(!0),[m,j]=i.useState(null);i.useEffect(()=>{if(!(t!=null&&t.id)){n(null),p(!1);return}try{const r=localStorage.getItem(`${O}_${t.id}`);n(r?JSON.parse(r):null)}catch(r){console.error("Error loading device:",r),n(null)}p(!1)},[t==null?void 0:t.id]);const o=i.useCallback(r=>{t!=null&&t.id&&(r?localStorage.setItem(`${O}_${t.id}`,JSON.stringify(r)):localStorage.removeItem(`${O}_${t.id}`),n(r))},[t==null?void 0:t.id]),w=i.useCallback(async r=>{if(!(t!=null&&t.id))throw new Error("User not authenticated");await new Promise(S=>setTimeout(S,1e3));const u={id:`device_${Date.now()}`,user_id:t.id,model:"Waves Neurofeedback v1",status:"ordered",shipping_address:r,ordered_at:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return o(u),u},[t==null?void 0:t.id,o]),l=i.useCallback(r=>{if(!s)return;const u={status:r,updated_at:new Date().toISOString()};r==="shipped"&&(u.shipped_at=new Date().toISOString(),u.tracking_number="SDEK-"+Math.random().toString(36).substring(2,10).toUpperCase(),u.carrier="sdek"),r==="delivered"&&(u.delivered_at=new Date().toISOString()),r==="setup_complete"&&(u.setup_completed_at=new Date().toISOString()),o({...s,...u})},[s,o]),g=i.useCallback(()=>{o(null)},[o]);return{device:s,loading:x,error:m,orderDevice:w,updateStatus:l,resetDevice:g,hasDevice:!!s,isOrdered:(s==null?void 0:s.status)==="ordered",isShipped:(s==null?void 0:s.status)==="shipped"||(s==null?void 0:s.status)==="in_transit",isDelivered:(s==null?void 0:s.status)==="delivered"||(s==null?void 0:s.status)==="setup_pending"||(s==null?void 0:s.status)==="setup_complete",isSetupComplete:(s==null?void 0:s.status)==="setup_complete"}}function se(){const{user:t}=P(),[s,n]=i.useState(new Set);i.useEffect(()=>{if(t!=null&&t.id)try{const l=localStorage.getItem(`${B}_${t.id}`);l&&n(new Set(JSON.parse(l)))}catch(l){console.error("Error loading device setup:",l)}},[t==null?void 0:t.id]),i.useEffect(()=>{if(t!=null&&t.id)try{localStorage.setItem(`${B}_${t.id}`,JSON.stringify([...s]))}catch(l){console.error("Error saving device setup:",l)}},[s,t==null?void 0:t.id]);const x=i.useCallback(l=>{n(g=>{const r=new Set(g);return r.has(l)?r.delete(l):r.add(l),r})},[]),p=i.useCallback(l=>{n(g=>new Set(g).add(l))},[]),m=i.useCallback(()=>{n(new Set)},[]),j=i.useCallback(l=>s.has(l),[s]),o={completed:s.size,total:6,percentage:Math.round(s.size/6*100)},w=s.size>=6;return{completedSteps:s,toggleStep:x,markComplete:p,reset:m,isStepComplete:j,progress:o,isAllComplete:w}}const te=[{id:"unpack",title:"Распаковать устройство",description:"Проверьте комплектацию и целостность"},{id:"charge",title:"Зарядить устройство",description:"Полностью зарядите перед первым использованием"},{id:"download_app",title:"Скачать приложение Waves",description:"Установите приложение на телефон",link:"https://waves.ai/app",linkText:"Скачать"},{id:"pair_device",title:"Подключить устройство к приложению",description:"Следуйте инструкциям в приложении"},{id:"test_signal",title:"Проверить качество сигнала",description:"Убедитесь, что устройство корректно считывает данные"},{id:"complete_tutorial",title:"Пройти обучение в приложении",description:"Завершите вводный инструктаж"}],ae=[{id:"what_included",category:"setup",question:"Что входит в комплект?",answer:"В комплект входит: устройство нейрофидбэка, зарядный кабель USB-C, краткая инструкция по началу работы, чехол для хранения."},{id:"how_charge",category:"setup",question:"Как заряжать устройство?",answer:"Подключите устройство к зарядному устройству через USB-C кабель. Полная зарядка занимает около 2 часов. Индикатор загорится зеленым, когда устройство полностью заряжено."},{id:"how_connect",category:"setup",question:"Как подключить устройство к телефону?",answer:'Откройте приложение Waves, перейдите в раздел "Устройство", нажмите "Подключить". Убедитесь, что Bluetooth включен. Следуйте инструкциям на экране.'},{id:"no_signal",category:"troubleshooting",question:"Устройство не ловит сигнал",answer:"Убедитесь, что электроды плотно прилегают к коже. Протрите контактные площадки влажной салфеткой. Проверьте заряд устройства. Если проблема сохраняется, обратитесь в поддержку."},{id:"not_connecting",category:"troubleshooting",question:"Устройство не подключается к телефону",answer:"Перезагрузите устройство и телефон. Убедитесь, что Bluetooth включен. Удалите устройство из списка сопряженных и подключите заново. Обновите приложение до последней версии."},{id:"battery_drain",category:"troubleshooting",question:"Батарея быстро разряжается",answer:"Это может быть связано с активным Bluetooth-соединением. Выключайте устройство после тренировки. Если батарея разряжается менее чем за 4 часа активного использования, обратитесь в поддержку."},{id:"how_clean",category:"care",question:"Как ухаживать за устройством?",answer:"Протирайте электроды влажной салфеткой после каждого использования. Храните в чехле в сухом месте. Не погружайте в воду. Избегайте падений и ударов."},{id:"session_duration",category:"usage",question:"Как часто проводить тренировки?",answer:"Рекомендуемая частота — 3-5 тренировок в неделю по 20-30 минут. Не проводите более одной тренировки в день. Следуйте рекомендациям вашего специалиста."}],re={not_ordered:"Не заказано",ordered:"Заказ оформлен",shipped:"Отправлено",in_transit:"В пути",delivered:"Доставлено",setup_pending:"Ожидает настройки",setup_complete:"Готово к работе"},le={not_ordered:"bg-muted text-muted-foreground",ordered:"bg-honey/20 text-honey-dark",shipped:"bg-sky-100 text-sky-700",in_transit:"bg-sky-100 text-sky-700",delivered:"bg-success/20 text-success",setup_pending:"bg-coral/20 text-coral",setup_complete:"bg-success/20 text-success"};function ge(){const t=G(),{device:s,loading:n,orderDevice:x,updateStatus:p,hasDevice:m,isDelivered:j,isSetupComplete:o}=ee(),{toggleStep:w,isStepComplete:l,progress:g,isAllComplete:r}=se(),[u,S]=i.useState(!1),[q,k]=i.useState(!1),[d,N]=i.useState({full_name:"",phone:"",city:"",address:"",postal_code:"",comment:""}),V=async a=>{if(a.preventDefault(),!d.full_name||!d.phone||!d.city||!d.address){D.error("Заполните все обязательные поля");return}S(!0);try{await x({full_name:d.full_name,phone:d.phone,city:d.city,address:d.address,postal_code:d.postal_code,comment:d.comment||void 0}),D.success("Заказ оформлен! Мы свяжемся с вами для подтверждения."),k(!1)}catch{D.error("Ошибка при оформлении заказа")}finally{S(!1)}};return n?e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Загрузка..."})})}):e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(f,{size:"2xl",className:"mb-2",children:"Моё устройство"}),e.jsx("p",{className:"text-muted-foreground",children:"Управление устройством нейрофидбэка"})]}),!m&&!q&&e.jsx(b,{className:"glass-elegant border-2 p-6 sm:p-8",children:e.jsxs("div",{className:"text-center max-w-md mx-auto",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-coral/10 flex items-center justify-center mx-auto mb-6",children:e.jsx(z,{className:"h-10 w-10 text-coral"})}),e.jsx(f,{size:"xl",className:"mb-3",children:"У вас ещё нет устройства"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Устройство нейрофидбэка входит в состав лицензии. Оформите заказ, и мы доставим его вам."}),e.jsxs(h,{size:"lg",onClick:()=>k(!0),className:"bg-gradient-to-r from-coral to-coral-light hover:opacity-90",children:[e.jsx(L,{className:"h-5 w-5 mr-2"}),"Заказать устройство"]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-border/50",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Или выберите подходящий план с устройством:"}),e.jsx(h,{variant:"outline",onClick:()=>t("/cabinet/licenses"),children:"Посмотреть лицензии"})]})]})}),!m&&q&&e.jsxs(b,{className:"glass-elegant border-2 p-6 sm:p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>k(!1),children:"← Назад"}),e.jsx(f,{size:"lg",children:"Оформление заказа"})]}),e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"full_name",children:"ФИО получателя *"}),e.jsx(C,{id:"full_name",value:d.full_name,onChange:a=>N(c=>({...c,full_name:a.target.value})),placeholder:"Иванов Иван Иванович",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"phone",children:"Телефон *"}),e.jsx(C,{id:"phone",type:"tel",value:d.phone,onChange:a=>N(c=>({...c,phone:a.target.value})),placeholder:"+7 (999) 123-45-67",required:!0})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"city",children:"Город *"}),e.jsx(C,{id:"city",value:d.city,onChange:a=>N(c=>({...c,city:a.target.value})),placeholder:"Москва",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"postal_code",children:"Индекс"}),e.jsx(C,{id:"postal_code",value:d.postal_code,onChange:a=>N(c=>({...c,postal_code:a.target.value})),placeholder:"123456"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"address",children:"Адрес доставки *"}),e.jsx(T,{id:"address",value:d.address,onChange:a=>N(c=>({...c,address:a.target.value})),placeholder:"Улица, дом, квартира",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"comment",children:"Комментарий к заказу"}),e.jsx(T,{id:"comment",value:d.comment,onChange:a=>N(c=>({...c,comment:a.target.value})),placeholder:"Домофон, подъезд, время доставки..."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[e.jsx(h,{type:"submit",disabled:u,className:"flex-1 bg-gradient-to-r from-coral to-coral-light hover:opacity-90",children:u?"Оформление...":"Оформить заказ"}),e.jsx(h,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Отмена"})]})]})]}),m&&s&&!j&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{className:"glass-elegant border-2 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(f,{size:"lg",children:"Статус заказа"}),e.jsx($,{className:_(le[s.status]),children:re[s.status]})]}),e.jsx(ie,{device:s}),s.tracking_number&&e.jsxs("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Отслеживание"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Номер отслеживания: ",e.jsx("span",{className:"font-mono",children:s.tracking_number})]}),s.carrier==="sdek"&&e.jsxs(h,{variant:"link",size:"sm",className:"px-0 h-auto mt-1",onClick:()=>window.open(`https://www.cdek.ru/track.html?order_id=${s.tracking_number}`,"_blank"),children:["Отследить на сайте СДЭК",e.jsx(F,{className:"h-3 w-3 ml-1"})]})]}),s.shipping_address&&e.jsxs("div",{className:"mt-4 p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Q,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Адрес доставки"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.shipping_address.full_name,e.jsx("br",{}),s.shipping_address.city,", ",s.shipping_address.address,s.shipping_address.postal_code&&`, ${s.shipping_address.postal_code}`]})]})]}),e.jsx(I,{}),!1]}),m&&s&&j&&!o&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(b,{className:"glass-elegant border-2 p-6 bg-gradient-to-br from-success/5 to-success/10",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-success/20 flex items-center justify-center flex-shrink-0",children:e.jsx(E,{className:"h-6 w-6 text-success"})}),e.jsxs("div",{children:[e.jsx(f,{size:"lg",children:"Устройство доставлено!"}),e.jsx("p",{className:"text-muted-foreground",children:"Теперь настройте его, следуя чек-листу ниже"})]})]})}),e.jsxs(b,{className:"glass-elegant border-2 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(f,{size:"lg",children:"Настройка устройства"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-coral to-coral-light transition-all duration-500",style:{width:`${g.percentage}%`}})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[g.completed,"/",g.total]})]})]}),e.jsx("div",{className:"space-y-3",children:te.map((a,c)=>{const y=l(a.id);return e.jsxs("div",{className:_("flex items-start gap-3 p-3 rounded-xl transition-all cursor-pointer",y?"opacity-60":"hover:bg-white/50"),onClick:()=>w(a.id),children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:y?e.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-success to-success/80 flex items-center justify-center",children:e.jsx(E,{className:"h-4 w-4 text-white"})}):e.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-muted-foreground/30 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:c+1})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:_("font-medium",y&&"line-through text-muted-foreground"),children:a.title}),a.description&&!y&&e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),a.link&&!y&&e.jsxs(h,{variant:"ghost",size:"sm",className:"h-7 px-2 text-coral",onClick:H=>{H.stopPropagation(),window.open(a.link,"_blank")},children:[e.jsx("span",{className:"text-xs mr-1",children:a.linkText||"Открыть"}),e.jsx(F,{className:"h-3 w-3"})]})]},a.id)})}),r&&e.jsx("div",{className:"mt-6 pt-6 border-t border-border/50 text-center",children:e.jsxs(h,{onClick:()=>p("setup_complete"),className:"bg-gradient-to-r from-success to-success/80",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Завершить настройку"]})})]}),e.jsx(I,{}),!1]}),m&&s&&o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(b,{className:"glass-elegant border-2 p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-coral/20 to-coral/10 flex items-center justify-center",children:e.jsx(X,{className:"h-8 w-8 text-coral"})}),e.jsxs("div",{children:[e.jsx(f,{size:"lg",children:s.model}),e.jsxs($,{className:"bg-success/20 text-success mt-1",children:[e.jsx(E,{className:"h-3 w-3 mr-1"}),"Готово к работе"]})]})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.serial_number&&e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Серийный номер"}),e.jsx("p",{className:"font-mono text-sm",children:s.serial_number})]}),s.delivered_at&&e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Дата получения"}),e.jsx("p",{className:"text-sm",children:new Date(s.delivered_at).toLocaleDateString("ru-RU")})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-border/50",children:e.jsxs(h,{variant:"outline",onClick:()=>window.open("https://waves.ai/app","_blank"),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Открыть приложение"]})})]}),e.jsx(I,{}),!1]})]})}function ie({device:t}){const s=[{id:"ordered",label:"Заказ оформлен",icon:Z},{id:"shipped",label:"Отправлено",icon:L},{id:"in_transit",label:"В пути",icon:U},{id:"delivered",label:"Доставлено",icon:E}],n=s.findIndex(x=>x.id===t.status);return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-5 left-0 right-0 h-0.5 bg-muted",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-coral to-coral-light transition-all duration-500",style:{width:`${n/(s.length-1)*100}%`}})}),e.jsx("div",{className:"relative flex justify-between",children:s.map((x,p)=>{const m=p<=n,j=p===n,o=x.icon;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:_("w-10 h-10 rounded-full flex items-center justify-center border-2 bg-background transition-all",m?"border-coral bg-coral/10":"border-muted-foreground/30"),children:e.jsx(o,{className:_("h-5 w-5",m?"text-coral":"text-muted-foreground/50")})}),e.jsx("span",{className:_("text-xs mt-2 text-center max-w-[80px]",j?"font-medium text-foreground":"text-muted-foreground"),children:x.label})]},x.id)})})]})}function I(){return e.jsxs(b,{className:"glass-elegant border-2 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(M,{className:"h-5 w-5 text-muted-foreground"}),e.jsx(f,{size:"lg",children:"Частые вопросы"})]}),e.jsx(R,{type:"single",collapsible:!0,className:"space-y-2",children:ae.map(t=>e.jsxs(W,{value:t.id,className:"border border-border/50 rounded-lg px-4",children:[e.jsx(J,{className:"text-left hover:no-underline py-4",children:e.jsx("span",{className:"text-sm font-medium",children:t.question})}),e.jsx(K,{className:"text-sm text-muted-foreground pb-4",children:t.answer})]},t.id))}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-border/50 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Не нашли ответ на свой вопрос?"}),e.jsxs(h,{variant:"outline",onClick:()=>window.open("https://t.me/waves_support_bot","_blank"),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Написать в поддержку"]})]})]})}export{ge as default};
