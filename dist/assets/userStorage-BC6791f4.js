import{ah as s,R as a,v as n}from"./index-Dt6uKTGi.js";import"./vendor-radix-CDHcN1cP.js";import"./vendor-charts-DMFz3Lzq.js";import"./vendor-query-DyYoeD25.js";import"./vendor-react-D0zZO7ze.js";async function w(){try{const t=await s();if(!t)return null;const{data:e,error:r}=await a.from("users").select("*").eq("id",t.id).single();if(r){if(r.code==="PGRST116")return null;throw r}return e}catch(t){return n.error("Error getting user data:",t),null}}async function f(t){try{const e=await s();if(!e)throw new Error("User not authenticated");const{error:r}=await a.from("users").update(t).eq("id",e.id);if(r)throw r}catch(e){throw n.error("Error updating user data:",e),e}}class i extends Error{constructor(){super("Пользователь с таким номером телефона уже зарегистрирован"),this.name="PhoneAlreadyExistsError"}}async function p(t){var e;try{const r=await s();if(!r)throw new Error("User not authenticated");const{error:o}=await a.from("users").upsert({id:r.id,email:r.email||t.email,...t},{onConflict:"id"});if(o)throw o.code==="23505"&&((e=o.message)!=null&&e.includes("users_phone_unique"))?new i:o}catch(r){throw n.error("Error upserting user data:",r),r}}export{i as PhoneAlreadyExistsError,w as getCurrentUserData,f as updateUserData,p as upsertUserData};
