import{r as t,j as e}from"./vendor-radix-CDHcN1cP.js";import{z as _,H as C,J as E,P as k,K as d,M as m,B as h,y as F,N as w}from"./index-Dt6uKTGi.js";import{u as A}from"./useAssessment-BVKN4Gk8.js";import{c as S}from"./checkupQuestions-CelrvA-2.js";import{u as z,e as I}from"./vendor-react-D0zZO7ze.js";import"./vendor-charts-DMFz3Lzq.js";import"./vendor-query-DyYoeD25.js";import"./assessmentStorage-BtF7XoQl.js";const l=S.length;function O(){const i=z(),f=I(),{currentProfileId:p}=_(),[s,j]=t.useState(null),[M,u]=t.useState(!0),[a,N]=t.useState(null),r=f.profileId||p,{currentStep:x,savedAnswers:c,loading:g}=A({assessmentType:"checkup",totalSteps:l,profileId:r}),b=t.useMemo(()=>c.size/l*100,[c.size]),y=t.useMemo(()=>Math.min(x,l),[x]),v=t.useCallback(n=>n?{type:"child",gender:n.gender||"female"}:{type:"child",gender:"female"},[]);return t.useEffect(()=>{async function n(){if(r)try{const o=await F(r);if(j(o),o){const P=w(o.dob);N(P)}}catch(o){console.error("Error loading profile:",o)}finally{u(!1)}else u(!1)}n()},[r]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(C,{}),e.jsx("div",{className:"border-b border-border bg-muted/30 py-4",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{value:b,className:"flex-1"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:g?"...":`${y} / ${l}`})]})})}),e.jsx("div",{className:"container mx-auto max-w-2xl px-4 py-20",children:e.jsxs("div",{className:"space-y-12 text-center",children:[e.jsx("div",{className:"mx-auto",children:e.jsx(k,{...v(s),size:"xl"})}),a&&!a.eligible?e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground",children:a.reason==="too_young"?e.jsxs(e.Fragment,{children:[(s==null?void 0:s.first_name)||"Ребенок"," ещё слишком ",(s==null?void 0:s.gender)==="male"?"мал":"мала"," для чекапа"]}):a.reason==="too_old"?e.jsxs(e.Fragment,{children:["Чекап предназначен для детей до ",d," лет"]}):e.jsx(e.Fragment,{children:"Не указана дата рождения"})}),e.jsx("p",{className:"text-lg text-muted-foreground",children:a.reason==="too_young"?e.jsxs(e.Fragment,{children:["Наш чекап разработан для детей от ",m," до ",d," лет.",s!=null&&s.first_name?` ${s.first_name}`:" Ребенку"," сейчас ",a.age," ",a.age===1?"год":a.age&&a.age<5?"года":"лет",". Вы сможете пройти чекап, когда ",(s==null?void 0:s.gender)==="male"?"ему":"ей"," исполнится ",m," года."]}):a.reason==="too_old"?e.jsxs(e.Fragment,{children:["Наш чекап разработан для детей от ",m," до ",d," лет. Для взрослых мы предлагаем другие инструменты оценки."]}):e.jsx(e.Fragment,{children:"Пожалуйста, укажите дату рождения в профиле ребенка."})}),e.jsx(h,{size:"lg",variant:"outline",onClick:()=>i("/dashboard"),className:"h-14 w-full max-w-md text-base font-medium",children:"Вернуться на главную"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:e.jsx("h1",{className:"text-5xl font-bold text-foreground",children:s?e.jsxs(e.Fragment,{children:["Давайте сосредоточимся на ",e.jsx("span",{className:"font-bold",children:s.first_name}),"."]}):e.jsx(e.Fragment,{children:"Давайте сосредоточимся на ребенке."})})}),e.jsx(h,{size:"lg",onClick:()=>{i(r?`/checkup-questions/${r}`:"/checkup")},className:"h-14 w-full max-w-md text-base font-medium",disabled:g,children:c.size>0?"Продолжим":"Начнем"})]})]})})]})}export{O as default};
