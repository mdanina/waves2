import{w as o,p as a}from"./index-Bu4m9iDU.js";async function g(e){const{data:t,error:r}=await o.from("client_documents").select("*").eq("client_user_id",e).is("deleted_at",null).order("created_at",{ascending:!1});if(r)throw a.error("Error fetching client documents:",r),new Error(`Failed to fetch documents: ${r.message}`);return t||[]}async function p(e){const{clientUserId:t,uploadedByUserId:r,filePath:s,fileName:c,fileSizeBytes:i,mimeType:d,description:n,category:m="other"}=e,{data:u,error:l}=await o.from("client_documents").insert({client_user_id:t,uploaded_by_user_id:r,file_path:s,file_name:c,file_size_bytes:i,mime_type:d,description:n||null,category:m}).select().single();if(l)throw a.error("Error creating client document:",l),new Error(`Failed to create document: ${l.message}`);if(!u)throw new Error("Failed to create document: No data returned");return u}async function w(e){const{error:t}=await o.from("client_documents").update({deleted_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",e);if(t)throw a.error("Error deleting client document:",t),new Error(`Failed to delete document: ${t.message}`)}async function _(e,t,r){const s=Date.now(),c=e.name.replace(/[^a-zA-Z0-9._-]/g,"_"),i=`${t}/${r}/${s}_${c}`,{data:d,error:n}=await o.storage.from("documents").upload(i,e,{contentType:e.type,upsert:!1});if(n)throw a.error("Error uploading document file:",n),new Error(`Failed to upload file: ${n.message}`);return d.path}async function h(e){const{data:t,error:r}=await o.storage.from("documents").createSignedUrl(e,3600);if(r)throw a.error("Error getting document URL:",r),new Error(`Failed to get document URL: ${r.message}`);return t.signedUrl}function y(e){switch(e){case"medical":return"Медицинский";case"assessment":return"Диагностика";case"consent":return"Согласие";case"other":default:return"Другое"}}export{h as a,g as b,p as c,w as d,y as g,_ as u};
