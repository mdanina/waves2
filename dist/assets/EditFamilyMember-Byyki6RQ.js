import{r as l,j as e}from"./vendor-radix-CDHcN1cP.js";import{u as A}from"./vendor-query-DyYoeD25.js";import{u as G,k as H,C as M,S as Q,L as s,x as q,a as D,b as I,c as P,d as z,e as i,B as L,y as K,f as x,o as T}from"./index-Dt6uKTGi.js";import{R as N,a as n}from"./radio-group-BCLlkBMv.js";import{B as $}from"./birth-date-picker-Bps1FAwS.js";import{u as J,a as U,e as W}from"./vendor-react-D0zZO7ze.js";import"./vendor-charts-DMFz3Lzq.js";import"./vendor-date-CR4liJ_d.js";function ie(){var V;const r=J(),c=U(),{id:d}=W(),O=A(),{user:h}=G(),[u,y]=l.useState(""),[p,S]=l.useState(""),[f,k]=l.useState(""),[j,C]=l.useState(""),[g,F]=l.useState(""),[v,w]=l.useState(""),[B,R]=l.useState(""),[b,E]=l.useState("");l.useEffect(()=>{async function t(){var o,m,_;if(d)try{const a=await K(d);if(a){if(a.type==="parent"){r("/profile",{state:{from:((o=c.state)==null?void 0:o.from)||"cabinet"},replace:!0});return}y(a.first_name),S(a.last_name||""),k(a.dob||""),C(a.type),F(a.gender||""),w(a.handedness||""),R(a.referral||""),E(a.seeking_care||"")}else x.error("Член семьи не найден"),((m=c.state)==null?void 0:m.from)==="cabinet"?r("/cabinet"):r("/family-members")}catch(a){console.error("Error loading profile:",a),x.error("Ошибка при загрузке данных"),((_=c.state)==null?void 0:_.from)==="cabinet"?r("/cabinet"):r("/family-members")}}t()},[d,r,(V=c.state)==null?void 0:V.from]);const Y=async t=>{var o;if(t.preventDefault(),u&&p&&f&&j&&g&&b&&d)try{await T(d,{firstName:u,lastName:p,dateOfBirth:f,relationship:j,sex:g,handedness:v||void 0,referral:B,seekingCare:b}),await O.invalidateQueries({queryKey:["profiles",h==null?void 0:h.id]}),x.success("Данные члена семьи обновлены!"),((o=c.state)==null?void 0:o.from)==="cabinet"?r("/cabinet"):r("/family-members")}catch(m){console.error("Error updating profile:",m),x.error("Ошибка при обновлении данных")}};return e.jsx("div",{className:"min-h-screen",style:{backgroundImage:`url(${H})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",backgroundRepeat:"no-repeat"},children:e.jsx("div",{className:"container mx-auto max-w-2xl px-4 py-12",children:e.jsx(M,{className:"rounded-[20px] border-2 bg-white p-8 shadow-[0_4px_20px_rgba(0,0,0,0.06)]",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"text-center",children:e.jsx(Q,{size:"2xl",className:"mb-4",children:"Редактировать данные члена семьи"})}),e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"firstName",children:["Имя ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(q,{id:"firstName",type:"text",value:u,onChange:t=>y(t.target.value),required:!0,className:"h-12 text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"lastName",children:["Фамилия ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(q,{id:"lastName",type:"text",value:p,onChange:t=>S(t.target.value),required:!0,className:"h-12 text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"dateOfBirth",children:["Дата рождения ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx($,{id:"dateOfBirth",value:f,onChange:k,required:!0,fromYear:new Date().getFullYear()-100,toYear:new Date().getFullYear()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"relationship",children:["Кем для вас приходится? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(D,{value:j,onValueChange:C,children:[e.jsx(I,{id:"relationship",className:"h-12 text-base",children:e.jsx(P,{placeholder:"Выберите"})}),e.jsxs(z,{children:[e.jsx(i,{value:"child",children:"Ребенок"}),e.jsx(i,{value:"partner",children:"Партнер"}),e.jsx(i,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(s,{children:["Пол ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(N,{value:g,onValueChange:F,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(n,{value:"male",id:"male-edit"}),e.jsx(s,{htmlFor:"male-edit",className:"flex-1 cursor-pointer font-normal",children:"Мужской"})]}),e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(n,{value:"female",id:"female-edit"}),e.jsx(s,{htmlFor:"female-edit",className:"flex-1 cursor-pointer font-normal",children:"Женский"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(s,{children:"Левша или правша?"}),e.jsxs(N,{value:v,onValueChange:w,className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(n,{value:"right",id:"handedness-right"}),e.jsx(s,{htmlFor:"handedness-right",className:"flex-1 cursor-pointer font-normal",children:"Правша"})]}),e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(n,{value:"left",id:"handedness-left"}),e.jsx(s,{htmlFor:"handedness-left",className:"flex-1 cursor-pointer font-normal",children:"Левша"})]}),e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(n,{value:"ambidextrous",id:"handedness-ambidextrous"}),e.jsx(s,{htmlFor:"handedness-ambidextrous",className:"flex-1 cursor-pointer font-normal",children:"Амбидекстр"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"referral",children:"Пришел по направлению от организации?"}),e.jsxs(D,{value:B,onValueChange:R,children:[e.jsx(I,{id:"referral",className:"h-12 text-base",children:e.jsx(P,{placeholder:"Нет направления"})}),e.jsxs(z,{children:[e.jsx(i,{value:"no",children:"Нет направления"}),e.jsx(i,{value:"insurance",children:"Страховая компания"}),e.jsx(i,{value:"doctor",children:"Врач"}),e.jsx(i,{value:"school",children:"Школа"}),e.jsx(i,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(s,{children:["Этот член семьи будет проходить нейротренинг? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(N,{value:b,onValueChange:E,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(n,{value:"yes",id:"seeking-yes-edit"}),e.jsx(s,{htmlFor:"seeking-yes-edit",className:"flex-1 cursor-pointer font-normal",children:"Да"})]}),e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(n,{value:"no",id:"seeking-no-edit"}),e.jsx(s,{htmlFor:"seeking-no-edit",className:"flex-1 cursor-pointer font-normal",children:"Нет"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(L,{type:"button",variant:"outline",size:"lg",onClick:()=>{var t;((t=c.state)==null?void 0:t.from)==="cabinet"?r("/cabinet"):r("/family-members")},className:"h-14 flex-1 text-base font-medium",children:"Отмена"}),e.jsx(L,{type:"submit",size:"lg",className:"h-14 flex-1 text-base font-medium",children:"Сохранить"})]})]})]})})})})}export{ie as default};
