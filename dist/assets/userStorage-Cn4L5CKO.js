import{w as s,p as a}from"./index-BetUtCwY.js";import{getCurrentUser as i}from"./profileStorage-Bslow6L6.js";import"./vendor-radix-ClAtPGFM.js";import"./vendor-charts-DLBwBPLi.js";import"./vendor-query-DNK10Tnx.js";import"./vendor-react-C_NXOhYK.js";async function l(){try{const t=await i();if(!t)return null;const{data:e,error:r}=await s.from("users").select("*").eq("id",t.id).single();if(r){if(r.code==="PGRST116")return null;throw r}return e}catch(t){return a.error("Error getting user data:",t),null}}async function p(t){try{const e=await i();if(!e)throw new Error("User not authenticated");const{error:r}=await s.from("users").update(t).eq("id",e.id);if(r)throw r}catch(e){throw a.error("Error updating user data:",e),e}}class n extends Error{constructor(){super("Пользователь с таким номером телефона уже зарегистрирован"),this.name="PhoneAlreadyExistsError"}}async function m(t){var e;try{const r=await i();if(!r)throw new Error("User not authenticated");const{error:o}=await s.from("users").upsert({id:r.id,email:r.email||t.email,...t},{onConflict:"id"});if(o)throw o.code==="23505"&&((e=o.message)!=null&&e.includes("users_phone_unique"))?new n:o}catch(r){throw a.error("Error upserting user data:",r),r}}export{n as PhoneAlreadyExistsError,l as getCurrentUserData,p as updateUserData,m as upsertUserData};
