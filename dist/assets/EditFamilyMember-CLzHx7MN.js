import{r as i,j as e}from"./vendor-radix-htwXsPHy.js";import{u as Y}from"./vendor-query-BNGVDYIL.js";import{u as I,H as _,L as s,o as w,b as E,c as R,d as q,e as D,f as a,B as V,g as m}from"./index-Dv2C02zj.js";import{R as L,a as x}from"./radio-group-TqOR4VZo.js";import{getProfile as z,updateProfile as G}from"./profileStorage-CNyPVPjQ.js";import{B as H}from"./birth-date-picker-RdMiatSZ.js";import{u as M,a as Q,e as A}from"./vendor-react-CI8wve7f.js";import"./vendor-charts-DjioKZbK.js";import"./vendor-date-CR4liJ_d.js";function se(){const l=M(),o=Q(),{id:n}=A(),O=Y(),{user:u}=I(),[h,N]=i.useState(""),[p,b]=i.useState(""),[f,y]=i.useState(""),[j,S]=i.useState(""),[v,C]=i.useState(""),[F,k]=i.useState(""),[g,B]=i.useState("");i.useEffect(()=>{async function r(){var c,d;if(n)try{const t=await z(n);t?(N(t.first_name),b(t.last_name||""),y(t.dob||""),S(t.type),C(t.gender||""),k(t.referral||""),B(t.seeking_care||"")):(m.error("Член семьи не найден"),((c=o.state)==null?void 0:c.from)==="cabinet"?l("/cabinet"):l("/family-members"))}catch(t){console.error("Error loading profile:",t),m.error("Ошибка при загрузке данных"),((d=o.state)==null?void 0:d.from)==="cabinet"?l("/cabinet"):l("/family-members")}}r()},[n,l]);const P=async r=>{var c;if(r.preventDefault(),h&&p&&f&&j&&v&&g&&n)try{await G(n,{firstName:h,lastName:p,dateOfBirth:f,relationship:j,sex:v,referral:F,seekingCare:g}),await O.invalidateQueries({queryKey:["profiles",u==null?void 0:u.id]}),m.success("Данные члена семьи обновлены!"),((c=o.state)==null?void 0:c.from)==="cabinet"?l("/cabinet"):l("/family-members")}catch(d){console.error("Error updating profile:",d),m.error("Ошибка при обновлении данных")}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(_,{}),e.jsx("div",{className:"container mx-auto max-w-2xl px-4 py-12",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"mb-4 text-4xl font-bold text-foreground",children:"Редактировать данные члена семьи"})}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"firstName",children:["Имя ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(w,{id:"firstName",type:"text",value:h,onChange:r=>N(r.target.value),required:!0,className:"h-12 text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"lastName",children:["Фамилия ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(w,{id:"lastName",type:"text",value:p,onChange:r=>b(r.target.value),required:!0,className:"h-12 text-base"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"dateOfBirth",children:["Дата рождения ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(H,{id:"dateOfBirth",value:f,onChange:y,required:!0,fromYear:new Date().getFullYear()-100,toYear:new Date().getFullYear()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(s,{htmlFor:"relationship",children:["Кем для вас приходится? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(E,{value:j,onValueChange:S,children:[e.jsx(R,{id:"relationship",className:"h-12 text-base",children:e.jsx(q,{placeholder:"Выберите"})}),e.jsxs(D,{children:[e.jsx(a,{value:"child",children:"Ребенок"}),e.jsx(a,{value:"partner",children:"Партнер"}),e.jsx(a,{value:"parent",children:"Родитель"}),e.jsx(a,{value:"sibling",children:"Брат/Сестра"}),e.jsx(a,{value:"caregiver",children:"Опекун"}),e.jsx(a,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(s,{children:["Пол ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(L,{value:v,onValueChange:C,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(x,{value:"male",id:"male-edit"}),e.jsx(s,{htmlFor:"male-edit",className:"flex-1 cursor-pointer font-normal",children:"Мужской"})]}),e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(x,{value:"female",id:"female-edit"}),e.jsx(s,{htmlFor:"female-edit",className:"flex-1 cursor-pointer font-normal",children:"Женский"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(s,{htmlFor:"referral",children:"Пришел по направлению от организации?"}),e.jsxs(E,{value:F,onValueChange:k,children:[e.jsx(R,{id:"referral",className:"h-12 text-base",children:e.jsx(q,{placeholder:"Нет направления"})}),e.jsxs(D,{children:[e.jsx(a,{value:"no",children:"Нет направления"}),e.jsx(a,{value:"insurance",children:"Страховая компания"}),e.jsx(a,{value:"doctor",children:"Врач"}),e.jsx(a,{value:"school",children:"Школа"}),e.jsx(a,{value:"other",children:"Другое"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(s,{children:["Этому члену семьи нужна помощь? ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(L,{value:g,onValueChange:B,className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(x,{value:"yes",id:"seeking-yes-edit"}),e.jsx(s,{htmlFor:"seeking-yes-edit",className:"flex-1 cursor-pointer font-normal",children:"Да"})]}),e.jsxs("div",{className:"flex items-center space-x-3 rounded-lg border border-input px-4 py-4",children:[e.jsx(x,{value:"no",id:"seeking-no-edit"}),e.jsx(s,{htmlFor:"seeking-no-edit",className:"flex-1 cursor-pointer font-normal",children:"Нет"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(V,{type:"button",variant:"outline",size:"lg",onClick:()=>{var r;((r=o.state)==null?void 0:r.from)==="cabinet"?l("/cabinet"):l("/family-members")},className:"h-14 flex-1 text-base font-medium",children:"Отмена"}),e.jsx(V,{type:"submit",size:"lg",className:"h-14 flex-1 text-base font-medium",children:"Сохранить"})]})]})]})})]})}export{se as default};
