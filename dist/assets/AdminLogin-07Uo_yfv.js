import{r as i,j as e}from"./vendor-radix-CDHcN1cP.js";import{ai as A,aj as S,C as E,$ as L,a0 as k,ak as R,i as B,A as c,s as j,t as d,ad as D,L as f,x as g,B as F}from"./index-Dt6uKTGi.js";import{u as I}from"./vendor-react-D0zZO7ze.js";import"./vendor-charts-DMFz3Lzq.js";import"./vendor-query-DyYoeD25.js";function T(){const[o,v]=i.useState(""),[m,w]=i.useState(""),[u,t]=i.useState(null),[r,x]=i.useState(!1),{signIn:N}=A(),y=I(),{isBlocked:s,attemptsRemaining:l,timeRemaining:h,recordFailedAttempt:p,resetAttempts:C}=S("admin_login_rate_limit"),b=async a=>{if(a.preventDefault(),s){t("Слишком много неудачных попыток. Попробуйте позже.");return}t(null),x(!0);try{const{error:n}=await N(o,m);n?(p(),t(n.message||"Ошибка входа. Проверьте email и пароль.")):(C(),y("/admin",{replace:!0}))}catch{p(),t("Произошла ошибка при входе. Попробуйте еще раз.")}finally{x(!1)}};return e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background p-4",children:e.jsxs(E,{className:"w-full max-w-md",children:[e.jsxs(L,{className:"space-y-1",children:[e.jsx(k,{className:"text-2xl font-bold",children:"Вход в админ-панель"}),e.jsx(R,{children:"Введите данные для входа в систему управления"})]}),e.jsx(B,{children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[s&&e.jsxs(c,{variant:"destructive",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsxs(d,{children:["Слишком много неудачных попыток входа. Попробуйте снова через"," ",Math.floor(h/60),":",(h%60).toString().padStart(2,"0")]})]}),!s&&l<5&&l>0&&e.jsxs(c,{children:[e.jsx(D,{className:"h-4 w-4"}),e.jsxs(d,{children:["Осталось попыток: ",l]})]}),u&&!s&&e.jsxs(c,{variant:"destructive",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx(d,{children:u})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"email",children:"Email"}),e.jsx(g,{id:"email",type:"email",placeholder:"admin@example.com",value:o,onChange:a=>v(a.target.value),required:!0,disabled:r||s})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"password",children:"Пароль"}),e.jsx(g,{id:"password",type:"password",value:m,onChange:a=>w(a.target.value),required:!0,disabled:r||s})]}),e.jsx(F,{type:"submit",className:"w-full",disabled:r||s,children:r?"Вход...":"Войти"})]})})]})})}export{T as default};
