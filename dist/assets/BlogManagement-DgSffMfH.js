const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B1ryaH4o.js","assets/vendor-radix-ClAtPGFM.js","assets/vendor-charts-DLBwBPLi.js"])))=>i.map(i=>d[i]);
import{r as x,j as e}from"./vendor-radix-ClAtPGFM.js";import{u as de,b as ue,c as D}from"./vendor-query-DNK10Tnx.js";import{w as j,ac as me,f,B as u,C as O,Q as z,R as B,af as U,h as H,N as he,D as A,E as M,G as $,_ as V,a0 as ge,L as m,q as _,a as xe,b as fe,c as je,d as pe,e as ye,a1 as be,a2 as G}from"./index-BetUtCwY.js";import{S as R}from"./switch-OPEz9IW7.js";import{T as J,a as W,b as K,c as h,d as X,e as g}from"./table-z2RnJ62P.js";import{u as ve,g as Y}from"./Blog-CVXGDyjG.js";import{P as Z}from"./plus-DZlllSoy.js";import{S as ee}from"./square-pen-D8Uo1qFh.js";import"./vendor-charts-DLBwBPLi.js";import"./vendor-react-C_NXOhYK.js";const se="blog-images";function _e(l,a){const c=a.name.split(".").pop()||"png",n=a.name.replace(/[^a-z0-9]+/gi,"-").toLowerCase(),i=Date.now();return`${l}/${i}-${n}.${c}`}async function te(l,a){const c=_e(a,l),{data:n,error:i}=await j.storage.from(se).upload(c,l,{cacheControl:"3600",upsert:!1});if(i)throw i;const{data:p}=j.storage.from(se).getPublicUrl(n.path);return p.publicUrl}const Ne=x.lazy(()=>me(()=>import("./index-B1ryaH4o.js").then(l=>l.i),__vite__mapDeps([0,1,2])).then(l=>({default:l.default}))),we={toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{align:[]}],[{indent:"-1"},{indent:"+1"}],[{list:"ordered"},{list:"bullet"}],[{direction:"rtl"}],["blockquote","code-block"],["link","image","video"],["clean"]],handlers:{image:function(){const l=document.createElement("input");l.setAttribute("type","file"),l.setAttribute("accept","image/*"),l.onchange=async()=>{const a=(l.files||[])[0];if(a)try{const c=await te(a,"content"),n=this.quill;if(!n)return;const i=n.getSelection(!0);if(i&&i.index!==null)n.insertEmbed(i.index,"image",c);else{const p=n.getLength();n.insertEmbed(Math.max(0,p-1),"image",c)}}catch(c){f.error(c.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ")}},l.click()}}}};function Ce({value:l,onChange:a,placeholder:c}){const[n,i]=x.useState(!1),p=x.useRef(null),P=l??"";return x.useEffect(()=>{i(!1);const w=setTimeout(()=>{i(!0)},300);return()=>{clearTimeout(w),i(!1)}},[]),n?e.jsx("div",{className:"blog-editor-wrapper",ref:p,children:e.jsx(x.Suspense,{fallback:e.jsx("div",{className:"flex h-64 items-center justify-center rounded-md border border-border bg-muted/50",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞..."})}),children:e.jsx(Ne,{theme:"snow",value:P,onChange:w=>a(w??""),placeholder:c,className:"bg-background text-foreground",modules:we})})}):e.jsx("div",{className:"flex h-64 items-center justify-center rounded-md border border-border bg-muted/50",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞..."})})}const Se=["üõü","üß∏","üî•","üåø","üí¨","üß†","‚≠ê","üíõ"];function Ie(){const l=de(),[a,c]=x.useState(null),[n,i]=x.useState(null),[p,P]=x.useState("posts"),[w,F]=x.useState(!1),[ae,I]=x.useState(0),[re,S]=x.useState(!1),[y,k]=x.useState(null);x.useEffect(()=>{const s=console.error,t=console.warn;return console.error=(...r)=>{var o,N,v,T;(N=(o=r[0])==null?void 0:o.includes)!=null&&N.call(o,"addRange")||(T=(v=r[0])==null?void 0:v.includes)!=null&&T.call(v,"The given range isn't in document")||s.apply(console,r)},console.warn=(...r)=>{var o,N,v,T;(N=(o=r[0])==null?void 0:o.includes)!=null&&N.call(o,"addRange")||(T=(v=r[0])==null?void 0:v.includes)!=null&&T.call(v,"The given range isn't in document")||t.apply(console,r)},()=>{console.error=s,console.warn=t}},[]);const{data:E,isLoading:Q}=ue({queryKey:["blog-posts-admin"],queryFn:async()=>{const{data:s,error:t}=await j.from("blog_posts").select("*").order("created_at",{ascending:!1});if(t)throw t;return s||[]}}),{data:b}=ve(),C=D({mutationFn:async s=>{const t={...s};if((t.content_html===null||t.content_html===void 0)&&(t.content_html=""),(t.subtitle===null||t.subtitle===void 0)&&(t.subtitle=""),(t.category===null||t.category===void 0)&&(t.category=""),(t.cover_image_url===null||t.cover_image_url===void 0)&&(t.cover_image_url=""),(t.author_name===null||t.author_name===void 0)&&(t.author_name=""),!t.slug&&t.title&&(t.slug=Y(t.title)),t.status==="published"?t.published_at||(t.published_at=new Date().toISOString()):t.status,t.id){if(t.is_featured===!0){const{error:o}=await j.from("blog_posts").update({is_featured:!1}).eq("is_featured",!0).neq("id",t.id);o&&console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–Ω—è—Ç–∏–∏ is_featured —Å –¥—Ä—É–≥–∏—Ö —Å—Ç–∞—Ç–µ–π:",o)}const{error:r}=await j.from("blog_posts").update(t).eq("id",t.id);if(r)throw r;return{id:t.id}}else{if(t.is_featured===!0){const{error:N}=await j.from("blog_posts").update({is_featured:!1}).eq("is_featured",!0);N&&console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–Ω—è—Ç–∏–∏ is_featured —Å –¥—Ä—É–≥–∏—Ö —Å—Ç–∞—Ç–µ–π:",N)}const{data:r,error:o}=await j.from("blog_posts").insert(t).select("id").single();if(o)throw o;return r}},onSuccess:s=>{if(f.success("–°—Ç–∞—Ç—å—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞"),a){const t={...a.post,...s.id?{id:s.id}:{}};k(t),a.isNew&&s.id&&c(r=>r?{...r,post:{...r.post,id:s.id},isNew:!1}:null)}l.removeQueries({queryKey:["blog-posts"]}),l.removeQueries({queryKey:["blog-posts-admin"]}),l.invalidateQueries({queryKey:["blog-posts"],refetchType:"all"}),l.invalidateQueries({queryKey:["blog-posts-admin"],refetchType:"all"}),l.refetchQueries({queryKey:["blog-posts"],type:"all"})},onError:s=>{f.error(s.message||"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ç—å—é")}}),le=D({mutationFn:async s=>{const{error:t}=await j.from("blog_posts").delete().eq("id",s);if(t)throw t},onSuccess:()=>{f.success("–°—Ç–∞—Ç—å—è —É–¥–∞–ª–µ–Ω–∞"),l.removeQueries({queryKey:["blog-posts"]}),l.removeQueries({queryKey:["blog-posts-admin"]}),l.invalidateQueries({queryKey:["blog-posts"],refetchType:"all"}),l.invalidateQueries({queryKey:["blog-posts-admin"],refetchType:"all"}),l.refetchQueries({queryKey:["blog-posts"],type:"all"})},onError:s=>{f.error(s.message||"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é")}}),ie=()=>{I(t=>t+1),S(!0);const s={title:"",slug:"",subtitle:"",category:"",cover_image_url:"",content_html:"",status:"draft",reading_time_minutes:5,author_name:"",is_featured:!1};k({...s}),c({isNew:!0,post:s})},ne=s=>{I(r=>r+1),S(!0);const t={...s,content_html:s.content_html||"",subtitle:s.subtitle||"",category:s.category||"",cover_image_url:s.cover_image_url||"",author_name:s.author_name||""};k({...t}),c({isNew:!1,post:t})},oe=()=>{if(!a||!y)return!1;const s=a.post;return s.title!==y.title||s.subtitle!==y.subtitle||s.content_html!==y.content_html||s.category_slug!==y.category_slug||s.cover_image_url!==y.cover_image_url||s.status!==y.status||s.reading_time_minutes!==y.reading_time_minutes||s.author_name!==y.author_name||s.is_featured!==y.is_featured},L=async(s=!1)=>{if(!s&&oe()){if(confirm("–£ –≤–∞—Å –µ—Å—Ç—å –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ —á–µ—Ä–Ω–æ–≤–∏–∫ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º?")){const r={...a.post,status:"draft"};await C.mutateAsync(r),c(null),k(null),S(!1);return}return}c(null),k(null),S(!1)},d=(s,t)=>{c(r=>r&&{...r,post:{...r.post,[s]:t}})},q=D({mutationFn:async s=>{const t={...s};if(!t.slug&&t.label&&(t.slug=Y(t.label)),t.id){const{error:r}=await j.from("blog_categories").update(t).eq("id",t.id);if(r)throw r;return{id:t.id}}else{const{data:r,error:o}=await j.from("blog_categories").insert(t).select("id").single();if(o)throw o;return r}},onSuccess:()=>{f.success("–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞"),i(null),l.invalidateQueries({queryKey:["blog-categories"]})},onError:s=>{f.error(s.message||"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é")}}),ce=D({mutationFn:async s=>{const{error:t}=await j.from("blog_categories").delete().eq("id",s);if(t)throw t},onSuccess:()=>{f.success("–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞"),l.invalidateQueries({queryKey:["blog-categories"]})},onError:s=>{f.error(s.message||"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é")}});return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"–ë–ª–æ–≥"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å—è–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –±–ª–æ–≥–∞."})]})}),e.jsxs("div",{className:"flex gap-2 border-b",children:[e.jsx(u,{variant:p==="posts"?"default":"ghost",onClick:()=>P("posts"),children:"–°—Ç–∞—Ç—å–∏"}),e.jsx(u,{variant:p==="categories"?"default":"ghost",onClick:()=>P("categories"),children:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"})]}),p==="posts"&&e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"–°—Ç–∞—Ç—å–∏"}),e.jsx(U,{children:"–ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã."})]}),e.jsxs(u,{onClick:ie,children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"–ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è"]})]})}),e.jsxs(H,{children:[Q&&e.jsx("div",{className:"flex min-h-[240px] items-center justify-center",children:e.jsx(he,{className:"h-6 w-6 animate-spin text-primary"})}),!Q&&E&&E.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"–°—Ç–∞—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç."}),!Q&&E&&E.length>0&&e.jsxs(J,{children:[e.jsx(W,{children:e.jsxs(K,{children:[e.jsx(h,{children:"–ó–∞–≥–æ–ª–æ–≤–æ–∫"}),e.jsx(h,{children:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è"}),e.jsx(h,{children:"–°—Ç–∞—Ç—É—Å"}),e.jsx(h,{children:"Hero"}),e.jsx(h,{children:"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ"}),e.jsx(h,{children:"–û–±–Ω–æ–≤–ª–µ–Ω–æ"}),e.jsx(h,{className:"text-right",children:"–î–µ–π—Å—Ç–≤–∏—è"})]})}),e.jsx(X,{children:E.map(s=>e.jsxs(K,{children:[e.jsx(g,{className:"font-medium",children:s.title}),e.jsx(g,{children:s.category}),e.jsx(g,{children:s.status==="published"?e.jsx("span",{className:"rounded-full bg-green-100 px-2 py-0.5 text-xs font-semibold text-green-800",children:"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ"}):e.jsx("span",{className:"rounded-full bg-muted px-2 py-0.5 text-xs font-semibold text-muted-foreground",children:"–ß–µ—Ä–Ω–æ–≤–∏–∫"})}),e.jsx(g,{children:s.is_featured?e.jsx("span",{className:"rounded-full bg-yellow-100 px-2 py-0.5 text-xs font-semibold text-yellow-800",children:"‚≠ê Hero"}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"‚Äî"})}),e.jsx(g,{children:s.published_at?new Date(s.published_at).toLocaleString("ru-RU"):"‚Äî"}),e.jsx(g,{children:s.updated_at?new Date(s.updated_at).toLocaleString("ru-RU"):"‚Äî"}),e.jsxs(g,{className:"space-x-2 text-right",children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>ne(s),children:[e.jsx(ee,{className:"mr-1 h-4 w-4"}),"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"]}),e.jsx(u,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>{confirm("–£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é?")&&le.mutate(s.id)},children:"–£–¥–∞–ª–∏—Ç—å"})]})]},s.id))})]})]})]}),p==="categories"&&e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"}),e.jsx(U,{children:"–°–ø–∏—Å–æ–∫ —Ç–µ–≥–æ–≤ –±–ª–æ–≥–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö –∏ —Å—Ç–∞—Ç—å—è—Ö."})]}),e.jsxs(u,{onClick:()=>i({isNew:!0,category:{label:"",slug:"",emoji:"",sort_order:0,is_active:!0}}),children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è"]})]})}),e.jsx(H,{children:!b||b.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –µ—â—ë –Ω–µ —Å–æ–∑–¥–∞–Ω—ã."}):e.jsxs(J,{children:[e.jsx(W,{children:e.jsxs(K,{children:[e.jsx(h,{children:"–ù–∞–∑–≤–∞–Ω–∏–µ"}),e.jsx(h,{children:"Slug"}),e.jsx(h,{children:"–≠–º–æ–¥–∑–∏"}),e.jsx(h,{children:"–ü–æ—Ä—è–¥–æ–∫"}),e.jsx(h,{children:"–ê–∫—Ç–∏–≤–Ω–∞"}),e.jsx(h,{className:"text-right",children:"–î–µ–π—Å—Ç–≤–∏—è"})]})}),e.jsx(X,{children:b.map(s=>e.jsxs(K,{children:[e.jsx(g,{className:"font-medium",children:s.label}),e.jsx(g,{children:s.slug}),e.jsx(g,{children:s.emoji}),e.jsx(g,{children:s.sort_order??0}),e.jsx(g,{children:s.is_active?"–î–∞":"–ù–µ—Ç"}),e.jsxs(g,{className:"space-x-2 text-right",children:[e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>i({isNew:!1,category:{...s}}),children:[e.jsx(ee,{className:"mr-1 h-4 w-4"}),"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"]}),e.jsx(u,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>{confirm("–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?")&&ce.mutate(s.id)},children:"–£–¥–∞–ª–∏—Ç—å"})]})]},s.id))})]})})]}),e.jsx(A,{open:!!a,onOpenChange:async s=>{S(s),!s&&!C.isPending&&await L()},children:e.jsx(M,{className:"max-h-[90vh] max-w-3xl overflow-y-auto",onOpenAutoFocus:s=>{s.preventDefault()},children:a&&e.jsxs(e.Fragment,{children:[e.jsxs($,{children:[e.jsx(V,{children:a.isNew?"–ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è":"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é"}),e.jsx(ge,{children:"–ó–∞–≥–æ–ª–æ–≤–æ–∫, —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏."})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–ó–∞–≥–æ–ª–æ–≤–æ–∫ *"}),e.jsx(_,{value:a.post.title||"",onChange:s=>d("title",s.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"Slug"}),e.jsx(_,{value:a.post.slug||"",placeholder:"–±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞",onChange:s=>d("slug",s.target.value)})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è"}),e.jsxs(xe,{value:a.post.category_slug||"",onValueChange:s=>{const t=(b==null?void 0:b.find(r=>r.slug===s))||null;d("category_slug",s),d("category",(t==null?void 0:t.label)||"")},children:[e.jsx(fe,{children:e.jsx(je,{placeholder:"–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é"})}),e.jsx(pe,{children:b==null?void 0:b.map(s=>e.jsxs(ye,{value:s.slug,children:[s.emoji&&e.jsx("span",{className:"mr-1",children:s.emoji}),s.label]},s.id))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–ê–≤—Ç–æ—Ä"}),e.jsx(_,{value:a.post.author_name||"",onChange:s=>d("author_name",s.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ / –ª–∏–¥"}),e.jsx(be,{rows:3,value:a.post.subtitle||"",onChange:s=>d("subtitle",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"–û–±–ª–æ–∂–∫–∞"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center",children:[e.jsx(_,{value:a.post.cover_image_url||"",onChange:s=>d("cover_image_url",s.target.value),placeholder:"URL –æ–±–ª–æ–∂–∫–∏ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –Ω–∏–∂–µ",className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{id:"cover-upload-input",type:"file",accept:"image/*",className:"hidden",onChange:async s=>{var r;const t=(r=s.target.files)==null?void 0:r[0];if(t)try{F(!0);const o=await te(t,"covers");d("cover_image_url",o),f.success("–û–±–ª–æ–∂–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")}catch(o){f.error(o.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±–ª–æ–∂–∫—É")}finally{F(!1),s.target.value=""}}}),e.jsx(u,{type:"button",variant:"outline",size:"sm",onClick:()=>{var s;return(s=document.getElementById("cover-upload-input"))==null?void 0:s.click()},disabled:w,children:w?"–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶":"–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"})]})]}),a.post.cover_image_url&&e.jsxs("div",{className:"relative w-full overflow-hidden rounded-lg border border-border bg-muted/50",children:[e.jsx("img",{src:a.post.cover_image_url,alt:"–ü—Ä–µ–≤—å—é –æ–±–ª–æ–∂–∫–∏",className:"h-auto w-full max-h-64 object-contain",onError:s=>{const t=s.target;t.style.display="none";const r=t.parentElement;r&&(r.innerHTML='<div class="flex h-32 items-center justify-center text-sm text-muted-foreground">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</div>')}}),e.jsx("div",{className:"absolute bottom-2 right-2 rounded-md bg-black/60 px-2 py-1 text-xs text-white",children:"–ü—Ä–µ–≤—å—é"})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-[1fr_auto]",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è (–º–∏–Ω)"}),e.jsx(_,{type:"number",min:1,value:a.post.reading_time_minutes??"",onChange:s=>d("reading_time_minutes",s.target.value?Number(s.target.value):null)})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{checked:a.post.status==="published",onCheckedChange:s=>{d("status",s?"published":"draft"),s&&!a.post.published_at&&d("published_at",new Date().toISOString())}}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:a.post.status==="published"?"–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ":"–ß–µ—Ä–Ω–æ–≤–∏–∫"}),a.post.status==="draft"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"–°—Ç–∞—Ç—å—è –Ω–µ –±—É–¥–µ—Ç –≤–∏–¥–Ω–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –±–ª–æ–≥–∞"}),a.post.status==="published"&&!a.post.published_at&&e.jsx("span",{className:"text-xs text-amber-600",children:"–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(m,{htmlFor:"is_featured",className:"text-base",children:"–ì–ª–∞–≤–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª (Hero)"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é –≤ hero-—Å–µ–∫—Ü–∏–∏ –∫–∞–∫ –≥–ª–∞–≤–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª"})]}),e.jsx(R,{id:"is_featured",checked:a.post.is_featured??!1,onCheckedChange:s=>{d("is_featured",s)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"–¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏"}),re&&a&&e.jsx(Ce,{value:a.post.content_html??"",onChange:s=>d("content_html",s||""),placeholder:"–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏..."},`editor-${ae}-${a.post.id||"new"}`)]})]}),e.jsxs(G,{className:"mt-4",children:[e.jsx(u,{variant:"outline",onClick:()=>L(!0),disabled:C.isPending,children:"–û—Ç–º–µ–Ω–∞"}),e.jsx(u,{onClick:()=>C.mutate(a.post),disabled:C.isPending||!a.post.title,children:C.isPending?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ‚Ä¶":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})]})]})})}),e.jsx(A,{open:!!n,onOpenChange:s=>!s&&!q.isPending&&i(null),children:e.jsx(M,{children:n&&e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsx(V,{children:n.isNew?"–ù–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è":"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é"})}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–ù–∞–∑–≤–∞–Ω–∏–µ"}),e.jsx(_,{value:n.category.label||"",onChange:s=>i(t=>t&&{...t,category:{...t.category,label:s.target.value}})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"Slug"}),e.jsx(_,{value:n.category.slug||"",placeholder:"–±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",onChange:s=>i(t=>t&&{...t,category:{...t.category,slug:s.target.value}})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–≠–º–æ–¥–∑–∏"}),e.jsx(_,{value:n.category.emoji||"",placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä, üî•",onChange:s=>i(t=>t&&{...t,category:{...t.category,emoji:s.target.value}})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:Se.map(s=>e.jsx("button",{type:"button",className:"flex h-7 w-7 items-center justify-center rounded-full border border-border bg-muted text-lg hover:bg-accent",onClick:()=>i(t=>t&&{...t,category:{...t.category,emoji:s}}),children:s},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(m,{children:"–ü–æ—Ä—è–¥–æ–∫"}),e.jsx(_,{type:"number",value:n.category.sort_order??0,onChange:s=>i(t=>t&&{...t,category:{...t.category,sort_order:Number(s.target.value)||0}})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx(R,{checked:n.category.is_active??!0,onCheckedChange:s=>i(t=>t&&{...t,category:{...t.category,is_active:s}})}),e.jsx("span",{className:"text-sm",children:"–ê–∫—Ç–∏–≤–Ω–∞"})]})]}),e.jsxs(G,{className:"mt-4",children:[e.jsx(u,{variant:"outline",onClick:()=>!q.isPending&&i(null),children:"–û—Ç–º–µ–Ω–∞"}),e.jsx(u,{onClick:()=>q.mutate(n.category),disabled:q.isPending||!n.category.label,children:q.isPending?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ‚Ä¶":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"})]})]})})})]})}export{Ie as default};
