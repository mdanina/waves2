# Воркфлоу Личного Кабинета Родителя

## Общая структура

```
┌─────────────────────────────────────────────────────────────┐
│                    ЛИЧНЫЙ КАБИНЕТ РОДИТЕЛЯ                   │
│                      (ClientLayout)                           │
│                                                               │
│  ┌──────────────┐              ┌──────────────────────────┐  │
│  │   Sidebar    │              │    Основной контент      │  │
│  │  (навигация) │              │    (Outlet)             │  │
│  └──────────────┘              └──────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

---

## 1. ГЛАВНАЯ СТРАНИЦА (Dashboard) - `/cabinet`

### Схематичное изображение экрана:

```
┌─────────────────────────────────────────────────────────────┐
│  [Sidebar]                                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  Привет, [Имя родителя]!                             │   │
│  │  Добро пожаловать в систему нейротренинга Waves     │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  С ЧЕГО НАЧАТЬ?                    [Прогресс: X%]    │   │
│  │                                                       │   │
│  │  ① ○ Оплатить лицензию              [Открыть →]      │   │
│  │  ② ○ Заказать доставку устройства  [Открыть →]      │   │
│  │  ③ ○ Познакомиться с методом      [Открыть →]       │   │
│  │  ④ ✓ Заполнить профили участников                   │   │
│  │  ⑤ ○ Настроить цели тренировок     [Открыть →]      │   │
│  │  ⑥ ○ Скачать мобильное приложение [Скачать →]       │   │
│  │  ⑦ ○ Привязать лицензии            [Открыть →]      │   │
│  │  ⑧ ○ Подключить устройство         [Открыть →]      │   │
│  │  ⑨ ○ Пройти инструктаж                              │   │
│  │                                                       │   │
│  │  [Свернуть/Развернуть]                               │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ВАША СЕМЬЯ                    [+ Добавить члена]  │   │
│  │                                                       │   │
│  │  [←] [Карточка 1] [Карточка 2] [Карточка 3] [→]    │   │
│  │                                                       │   │
│  │  ┌──────────────┐                                    │   │
│  │  │  [Аватар]     │                                    │   │
│  │  │  [Имя]        │                                    │   │
│  │  │  [Возраст]    │                                    │   │
│  │  │  [Редактировать] [Удалить]                       │   │
│  │  └──────────────┘                                    │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ЕСТЬ ВОПРОСЫ?                                       │   │
│  │  Напишите в поддержку...                            │   │
│  │  [Написать в поддержку]                             │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

### Комментарии:
- **Приветствие**: Показывает имя родителя из профиля
- **Onboarding Checklist**: 
  - Чек-лист из 9 шагов онбординга
  - Показывает прогресс в процентах
  - Некоторые пункты проверяются автоматически (лицензия, устройство, профили)
  - Некоторые пункты требуют ручного подтверждения
  - Пункты, требующие доставки устройства, неактивны до получения устройства
  - Можно свернуть/развернуть
  - После завершения всех шагов можно скрыть чек-лист
- **Ваша семья**: 
  - Горизонтальная прокрутка карточек членов семьи
  - Для каждого члена: аватар, имя, возраст
  - Кнопки: редактирование, удаление (только для детей)
- **Поддержка**: Ссылка на Telegram-бот поддержки

### Переходы:
- `[+ Добавить члена]` → `/family-members`
- `[Редактировать]` → `/edit-family-member/:id` (для детей) или `/profile` (для родителя)
- Пункты чек-листа ведут на соответствующие страницы (лицензии, устройство, профили, цели и т.д.)

---

## 2. ДРУГИЕ РАЗДЕЛЫ КАБИНЕТА

### 2.1. НАСТРОЙКИ (Settings) - `/cabinet/settings`

```
┌─────────────────────────────────────────────────────────────┐
│  [Sidebar]                                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  НАСТРОЙКИ                                            │   │
│  │                                                       │   │
│  │  [Профиль] [Уведомления] [Безопасность]             │   │
│  │                                                       │   │
│  │  ┌───────────────────────────────────────────────┐   │   │
│  │  │  ПРОФИЛЬ                                       │   │   │
│  │  │                                                │   │   │
│  │  │  Имя: [________________]                        │   │   │
│  │  │  Фамилия: [________________]                  │   │   │
│  │  │  Дата рождения: [__/__/____]                  │   │   │
│  │  │  Пол: ○ Мужской ○ Женский                    │   │   │
│  │  │  Телефон: [________________]                 │   │   │
│  │  │  Email: [________________]                    │   │   │
│  │  │  Регион: [Выбрать ▼]                         │   │   │
│  │  │  Часовой пояс: [Выбрать ▼]                   │   │   │
│  │  │                                                │   │   │
│  │  │  [Сохранить]                                  │   │   │
│  │  └───────────────────────────────────────────────┘   │   │
│  │                                                       │   │
│  │  ┌───────────────────────────────────────────────┐   │   │
│  │  │  УВЕДОМЛЕНИЯ                                   │   │   │
│  │  │                                                │   │   │
│  │  │  Push-уведомления: [ON/OFF]                   │   │   │
│  │  │  Telegram-уведомления: [ON/OFF]               │   │   │
│  │  │  Email-уведомления: [ON/OFF]                  │   │   │
│  │  │                                                │   │   │
│  │  │                                                │   │   │
│  │  │                                                │   │   │
│  │  │  [Сохранить]                                  │   │   │
│  │  └───────────────────────────────────────────────┘   │   │
│  │                                                       │   │
│  │  ┌───────────────────────────────────────────────┐   │   │
│  │  │  БЕЗОПАСНОСТЬ                                   │   │   │
│  │  │                                                │   │   │
│  │  │  [Изменить пароль]                             │   │   │
│  │  │  [Двухфакторная аутентификация]                │   │   │
│  │  └───────────────────────────────────────────────┘   │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- **Вкладки**: Профиль, Уведомления, Безопасность
- **Профиль**: Редактирование данных родителя
- **Уведомления**: Настройка всех типов уведомлений
- **Безопасность**: Смена пароля, 2FA

**Переходы:**
- `[Сохранить]` → Сохранение изменений
- `[Изменить пароль]` → Модальное окно смены пароля

---

### 2.2. Сообщения - `/cabinet/messages`

```
┌─────────────────────────────────────────────────────────────┐
│  [Sidebar]                                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  СООБЩЕНИЯ                                           │   │
│  │                                                       │   │
│  │  ┌──────────────────┐  ┌─────────────────────────┐ │   │
│  │  │  Список чатов     │  │  Область сообщений      │ │   │
│  │  │                  │  │                         │ │   │
│  │  │  [Чат 1]         │  │  [История сообщений]    │ │   │
│  │  │  [Чат 2]         │  │                         │ │   │
│  │  │  [Чат 3]         │  │  [Поле ввода]           │ │   │
│  │  │                  │  │  [Отправить]            │ │   │
│  │  └──────────────────┘  └─────────────────────────┘ │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Переписка с поддержкой и специалистами
- Список чатов слева, область сообщений справа
- Realtime обновления сообщений

---

### 2.3. Мое нейроустройство - `/cabinet/device`

```
┌─────────────────────────────────────────────────────────────┐
│  [Sidebar]                                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  МОЕ НЕЙРОУСТРОЙСТВО                                 │   │
│  │                                                       │   │
│  │  [Информация об устройстве]                          │   │
│  │  [Статус подключения]                                │   │
│  │  [История использования]                             │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Управление нейроустройством
- Статус подключения
- История использования

---

### 2.4. Мои лицензии - `/cabinet/licenses`

```
┌─────────────────────────────────────────────────────────────┐
│  [Sidebar]                                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  МОИ ЛИЦЕНЗИИ                                        │   │
│  │                                                       │   │
│  │  ┌───────────────────────────────────────────────┐   │   │
│  │  │  Лицензия #1                                   │   │   │
│  │  │  Статус: Активна                               │   │   │
│  │  │  Срок действия: [дата]                         │   │   │
│  │  │  Привязанное устройство: [устройство]          │   │   │
│  │  └───────────────────────────────────────────────┘   │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Список лицензий
- Статус и срок действия
- Привязанные устройства

---

### 2.5. Цели тренировок - `/cabinet/goals`

```
┌─────────────────────────────────────────────────────────────┐
│  [Sidebar]                                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ЦЕЛИ ТРЕНИРОВОК                                     │   │
│  │                                                       │   │
│  │  [Установка целей]                                   │   │
│  │  [Прогресс по целям]                                 │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Установка и отслеживание целей тренировок
- Прогресс по целям

---

### 5.5. Прогресс - `/checkup-history`

```
┌─────────────────────────────────────────────────────────────┐
│  [Sidebar]                                                   │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ПРОГРЕСС                                            │   │
│  │                                                       │   │
│  │  [Графики прогресса]                                 │   │
│  │  [История тренировок]                                │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Графики и статистика тренировок
- История тренировок
- Отслеживание прогресса

---

## 4. УПРАВЛЕНИЕ СЕМЬЕЙ

### 6.1. Список членов семьи - `/family-members`

```
┌─────────────────────────────────────────────────────────────┐
│  [Header]                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ЧЛЕНЫ СЕМЬИ                                         │   │
│  │                                                       │   │
│  │  ┌───────────────────────────────────────────────┐   │   │
│  │  │  [Аватар] [Имя родителя]                      │   │   │
│  │  │  [Редактировать]                              │   │   │
│  │  └───────────────────────────────────────────────┘   │   │
│  │                                                       │   │
│  │  ┌───────────────────────────────────────────────┐   │   │
│  │  │  [Аватар] [Имя ребенка]                        │   │   │
│  │  │  [Редактировать] [Удалить]                     │   │   │
│  │  └───────────────────────────────────────────────┘   │   │
│  │                                                       │   │
│  │  [+ Добавить члена семьи]                           │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Список всех членов семьи
- Родитель и дети
- Добавление новых членов

**Переходы:**
- `[+ Добавить члена семьи]` → `/add-family-member`
- `[Редактировать]` → `/edit-family-member/:id` (для детей) или `/profile` (для родителя)

---

### 4.2. Добавление члена семьи - `/add-family-member`

```
┌─────────────────────────────────────────────────────────────┐
│  [Header]                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ДОБАВИТЬ ЧЛЕНА СЕМЬИ                                │   │
│  │                                                       │   │
│  │  Имя: [________________]                             │   │
│  │  Фамилия: [________________]                         │   │
│  │  Дата рождения: [__/__/____]                         │   │
│  │  Пол: ○ Мужской ○ Женский                           │   │
│  │                                                       │   │
│  │  [Отмена]              [Сохранить]                  │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Форма добавления нового члена семьи (ребенка)
- Валидация данных

**Переходы:**
- `[Сохранить]` → `/family-members` (после успешного добавления)
- `[Отмена]` → `/family-members`

---

### 4.3. Редактирование члена семьи - `/edit-family-member/:id`

```
┌─────────────────────────────────────────────────────────────┐
│  [Header]                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  РЕДАКТИРОВАТЬ ЧЛЕНА СЕМЬИ                            │   │
│  │                                                       │   │
│  │  Имя: [________________]                             │   │
│  │  Фамилия: [________________]                         │   │
│  │  Дата рождения: [__/__/____]                         │   │
│  │  Пол: ○ Мужской ○ Женский                           │   │
│  │                                                       │   │
│  │  [Отмена]              [Сохранить]                  │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Редактирование данных ребенка
- Аналогичная форма как при добавлении

**Переходы:**
- `[Сохранить]` → `/family-members` (после успешного сохранения)
- `[Отмена]` → `/family-members`

---

### 6.4. Профиль родителя - `/profile`

```
┌─────────────────────────────────────────────────────────────┐
│  [Header]                                                    │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  ПРОФИЛЬ РОДИТЕЛЯ                                     │   │
│  │                                                       │   │
│  │  Имя: [________________]                             │   │
│  │  Фамилия: [________________]                         │   │
│  │  Дата рождения: [__/__/____]                         │   │
│  │  Пол: ○ Мужской ○ Женский                           │   │
│  │  Телефон: [________________]                         │   │
│  │  Email: [________________]                           │   │
│  │  Регион: [Выбрать ▼]                                │   │
│  │                                                       │   │
│  │  [Сохранить]                                         │   │
│  │                                                       │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

**Комментарии:**
- Редактирование профиля родителя
- Используется при первом входе (онбординг) и для редактирования

**Переходы:**
- `[Сохранить]` → `/cabinet` (после успешного сохранения)

---

## 5. САЙДБАР (Sidebar Navigation)

```
┌─────────────────────┐
│   [Логотип Waves]    │
├─────────────────────┤
│                     │
│  🏠 Главная         │
│  💳 Мои лицензии    │
│  📱 Мое устройство  │
│  🎯 Цели тренировок │
│  📈 Прогресс        │
│  ❓ Поддержка        │
│                     │
├─────────────────────┤
│  [Аватар] [Имя]     │
│  [Email]            │
│  [Настройки]        │
│  [Выйти]            │
└─────────────────────┘
```

**Комментарии:**
- Фиксированный сайдбар слева (на десктопе)
- Мобильное меню (гамбургер) на мобильных устройствах
- Навигация по основным разделам
- Профиль пользователя внизу

---

## 6. ОСНОВНЫЕ ПЕРЕХОДЫ И ЛОГИКА

### 6.1. Онбординг (первый вход)
1. `/profile` - Создание профиля родителя
2. `/family-members` - Добавление членов семьи
3. `/cabinet` - Главная страница с Onboarding Checklist

### 6.2. Управление семьей
1. `/cabinet` - Нажатие "Добавить члена семьи"
2. `/family-members` - Список членов
3. `/add-family-member` - Добавление
4. `/edit-family-member/:id` - Редактирование
5. `/cabinet` - Возврат на главную

---

## 7. ОСОБЕННОСТИ И ОГРАНИЧЕНИЯ

### 7.1. Onboarding Checklist
- **Автоматическая проверка**: Лицензии, устройства, профили проверяются автоматически
- **Ручная проверка**: Некоторые пункты требуют ручного подтверждения пользователем
- **Условия активации**: Пункты, требующие доставки устройства, неактивны до получения устройства (status === 'delivered')
- **Скрытие**: После завершения всех шагов можно скрыть чек-лист

### 7.2. Управление профилями
- **Родитель**: Можно редактировать, нельзя удалить
- **Дети**: Можно редактировать и удалять
- **Валидация**: Проверка возраста, обязательных полей

---

## 10. СОСТОЯНИЯ И УСЛОВИЯ

### 10.1. Условия отображения на Dashboard
- **Onboarding Checklist**: 
  - Всегда показывается, если не скрыт пользователем
  - Автоматически проверяет: наличие лицензий, устройств, профилей
  - Пункты, требующие доставки устройства, неактивны до получения устройства

### 8.2. Уведомления
- Realtime обновления сообщений
- Push-уведомления (если разрешены)
- Email-уведомления

---

## 9. ТЕХНИЧЕСКИЕ ДЕТАЛИ

### 9.1. Роутинг
- Все страницы кабинета используют `ClientLayout` с сайдбаром
- Защищенные маршруты через `ProtectedRoute`
- Lazy loading для оптимизации

### 11.2. Состояние
- `AuthContext` - аутентификация
- `ProfileContext` - текущий профиль
- React Query для кеширования данных

### 9.3. Данные
- Supabase для хранения данных
- LocalStorage для некоторых настроек
- Realtime подписки для сообщений

---

## ЗАКЛЮЧЕНИЕ

Данный документ описывает полный воркфлоу личного кабинета родителя, включая все экраны, переходы, условия и особенности. Схематичные изображения экранов помогают визуализировать структуру интерфейса, а комментарии объясняют логику работы каждого раздела.
